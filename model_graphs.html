<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>model_graphs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="model_graphs_files/libs/clipboard/clipboard.min.js"></script>
<script src="model_graphs_files/libs/quarto-html/quarto.js"></script>
<script src="model_graphs_files/libs/quarto-html/popper.min.js"></script>
<script src="model_graphs_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="model_graphs_files/libs/quarto-html/anchor.min.js"></script>
<link href="model_graphs_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="model_graphs_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="model_graphs_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="model_graphs_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="model_graphs_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">model_graphs</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="set-up-workspace" class="level2">
<h2 class="anchored" data-anchor-id="set-up-workspace">Set up workspace</h2>
</section>
<section id="set-the-interval-for-single-interval-plots" class="level2">
<h2 class="anchored" data-anchor-id="set-the-interval-for-single-interval-plots">Set the interval for single interval plots</h2>
<p>Time 1 is from February to August. Time 2 is from August to February.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>timing <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Documents/GitHub/Bglandula_FHL_energetics/code/save_workspace"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"my_work_space_time1_20210409.RData"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  timing <span class="ot">&lt;-</span> <span class="dv">1</span>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"my_work_space_time2_20210409.RData"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  timing <span class="ot">&lt;-</span> <span class="dv">2</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate average barnacle sizes (length, cm)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(Iter.len<span class="fl">.2</span>[<span class="dv">1</span>,])) <span class="co">#0.23</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2319636</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(Iter.len<span class="fl">.1</span>[<span class="dv">1</span>,])) <span class="co">#0.22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2171867</code></pre>
</div>
</div>
<p>Pick representative barnacles that are close to these sizes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.1[1,Iter.len.1[1,]&gt;=.215&amp;Iter.len.1[1,]&lt;=.235] #V27 is .222, V110 is .220, V143 is .229</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.1[1, Elevation.list[[1]]=="Mid"]#108-143 </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.1[1, Elevation.list[[1]]=="Low"]#</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Iter.len.2[1,]&gt;=.205&amp;Iter.len.2[1,]&lt;=.235]</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1, Elevation.list[[2]]=="Upper"]#1-92 - V1 is 0.205, V32 is 0.221</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1, Elevation.list[[2]]=="Mid"]#93-108 - V94 is 0.20, V100 is 0.23</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1, Elevation.list[[2]]=="Low"]#109-138 - V124 is 0.209, V121 is 0.225</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Iter.len.2[1,Elevation.list[[2]]=="Mid"]&gt;=.20&amp;Iter.len.2[1,Elevation.list[[2]]=="Mid"]&lt;=.225] #V114 is 0.222</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Iter.len.2[1,Elevation.list[[2]]=="Low"]&gt;=.225&amp;Iter.len.2[1,Elevation.list[[2]]=="Low"]&lt;=.23]</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Elevation.list[[2]]=="Mid"]</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Elevation.list[[2]]=="Low"]</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Set representative barnacles ####</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">110</span>,<span class="dv">147</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  elev<span class="fl">.1</span> <span class="ot">&lt;-</span> elev</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">36</span>,<span class="dv">100</span>,<span class="dv">121</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  elev<span class="fl">.2</span> <span class="ot">&lt;-</span> elev</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> elev<span class="fl">.1</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  datetime_int <span class="ot">&lt;-</span> datetimes[[<span class="dv">1</span>]]</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  Iter.len<span class="fl">.1</span>[<span class="dv">1</span>,elev] <span class="co">#0.21, 0.22, 0.20</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  cutoff <span class="ot">&lt;-</span> <span class="dv">189</span> <span class="co">#This should be 188 or 189 but maybe I'm cutting off points twice? </span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Iter.len<span class="fl">.1</span>[,elev[<span class="dv">1</span>]])<span class="sc">/</span><span class="dv">96</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 189.0104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> elev<span class="fl">.2</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  datetime_int <span class="ot">&lt;-</span> datetimes[[<span class="dv">2</span>]]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Iter.len<span class="fl">.2</span>[,elev[<span class="dv">1</span>]])<span class="sc">/</span><span class="dv">96</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  cutoff <span class="ot">&lt;-</span> <span class="dv">186</span> <span class="co">#This should be 198 - we are missing 8 days?</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cutoff &lt;- 196</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(Iter.len<span class="fl">.2</span>[,elev]) <span class="co">#V95 (mid) was a little small, but changed rep barnacles in beginning of April</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>Elev.abbrev.list <span class="ot">&lt;-</span> <span class="fu">list</span>(elev<span class="fl">.1</span>, elev<span class="fl">.2</span>) <span class="co">#Need to run timing 1 and 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary statistics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Upper emergence time</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>no.na.water <span class="ot">&lt;-</span> water.temp[<span class="sc">!</span><span class="fu">is.na</span>(water.temp[,<span class="dv">2</span>]),<span class="dv">2</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>no.na.air <span class="ot">&lt;-</span> air.temp[<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">2</span>]),<span class="dv">2</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(no.na.air)<span class="sc">/</span>(<span class="fu">length</span>(no.na.water)<span class="sc">+</span><span class="fu">length</span>(no.na.air))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72.18116</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mid emergence time</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>no.na.water <span class="ot">&lt;-</span> water.temp[<span class="sc">!</span><span class="fu">is.na</span>(water.temp[,<span class="dv">3</span>]),<span class="dv">3</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>no.na.air <span class="ot">&lt;-</span> air.temp[<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">3</span>]),<span class="dv">3</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(no.na.air)<span class="sc">/</span>(<span class="fu">length</span>(no.na.water)<span class="sc">+</span><span class="fu">length</span>(no.na.air))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.00277</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lower emergence time</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>no.na.water <span class="ot">&lt;-</span> water.temp[<span class="sc">!</span><span class="fu">is.na</span>(water.temp[,<span class="dv">4</span>]),<span class="dv">4</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>no.na.air <span class="ot">&lt;-</span> air.temp[<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">4</span>]),<span class="dv">4</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(no.na.air)<span class="sc">/</span>(<span class="fu">length</span>(no.na.water)<span class="sc">+</span><span class="fu">length</span>(no.na.air))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33.41369</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>air.temp[<span class="fu">max</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">2</span>])),<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-08-07 01:00:00 GMT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>air.temp[<span class="fu">min</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">2</span>])),<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#max(no.na.air)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#min(no.na.water)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Temp graphs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temps_15_min_int1and2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp[,<span class="dv">4</span>], <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>), <span class="at">ylab =</span> <span class="st">"Temperature deg C"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp[,<span class="dv">4</span>],  <span class="at">pch =</span> <span class="st">"."</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Low"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp[,<span class="dv">3</span>], <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>), <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp[,<span class="dv">3</span>],  <span class="at">pch =</span> <span class="st">"."</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Mid"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#points(intake_15min_scaled[,2], col = "green", pch = ".")</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>), <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp[,<span class="dv">2</span>],  <span class="at">pch =</span> <span class="st">"."</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#points(intake_15min_scaled[,3], col = "green", pch = ".")</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert from UCT to PST</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(datetime_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018-02-04 GMT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(datetime_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018-08-12 GMT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(datetime_int<span class="sc">&gt;=</span><span class="fu">as.POSIXct</span>(<span class="st">"2018-08-01 00:00:00"</span>)<span class="sc">&amp;</span>datetime_int<span class="sc">&lt;=</span><span class="fu">as.POSIXct</span>(<span class="st">"2018-08-02 00:00:00"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 17105 17106 17107 17108 17109 17110 17111 17112 17113 17114 17115 17116
[13] 17117 17118 17119 17120 17121 17122 17123 17124 17125 17126 17127 17128
[25] 17129 17130 17131 17132 17133 17134 17135 17136 17137 17138 17139 17140
[37] 17141 17142 17143 17144 17145 17146 17147 17148 17149 17150 17151 17152
[49] 17153 17154 17155 17156 17157 17158 17159 17160 17161 17162 17163 17164
[61] 17165 17166 17167 17168 17169 17170 17171 17172 17173 17174 17175 17176
[73] 17177 17178 17179 17180 17181 17182 17183 17184 17185 17186 17187 17188
[85] 17189 17190 17191 17192 17193 17194 17195 17196 17197 17198 17199 17200
[97] 17201</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>conv <span class="ot">&lt;-</span> <span class="dv">17105</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#i_seq &lt;- 100</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Iter.air)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18145   153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#And then again last day (repeat)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>i_seq <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> ts<span class="sc">*</span>(i_seq<span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> i<span class="sc">+</span>ts<span class="dv">-1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>temp_i.w <span class="ot">&lt;-</span> Iter.water[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>temp_i.a <span class="ot">&lt;-</span> Iter.air[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>food_i <span class="ot">&lt;-</span> Iter.food[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv)]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>cost_15min_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cost_15min[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),])</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>intake_15min_scaled_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(intake_15min_scaled[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),])</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>pred_expose_30_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_expose_30[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),])</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>Hour <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="at">to =</span> <span class="dv">96</span><span class="sc">*</span><span class="dv">15</span>, <span class="at">by =</span> <span class="dv">15</span>)<span class="sc">/</span><span class="dv">60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("within_day_rates_15_min_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>),<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>),<span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_rates_15_min_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),<span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries1_physio-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries1_temp-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Physiological rates over 1 day, end ####</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This isn't computing for both beginning and end separately I don't think. </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#i_seq &lt;- 100</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Iter.air)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18145   153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#And then again last day (repeat)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>i_seq <span class="ot">&lt;-</span> end</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> ts<span class="sc">*</span>(i_seq<span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> i<span class="sc">+</span>ts<span class="dv">-1</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>temp_i.w <span class="ot">&lt;-</span> Iter.water[i<span class="sc">:</span>j,]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>temp_i.a <span class="ot">&lt;-</span> Iter.air[i<span class="sc">:</span>j,]</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>food_i <span class="ot">&lt;-</span> Iter.food[i<span class="sc">:</span>j]</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>cost_15min_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cost_15min[i<span class="sc">:</span>j,])</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>intake_15min_scaled_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(intake_15min_scaled[i<span class="sc">:</span>j,])</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>pred_expose_30_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_expose_30[i<span class="sc">:</span>j,])</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>Hour <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="at">to =</span> <span class="dv">96</span><span class="sc">*</span><span class="dv">15</span>, <span class="at">by =</span> <span class="dv">15</span>)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_rates_15_min_int1_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">col =</span> <span class="st">"blue"</span>,)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries2_physio-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_rates_15_min_int2_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">col =</span> <span class="st">"blue"</span>,)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int1_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span><span class="st">"darkorchid4"</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries2_temp-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int2_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Growth curve</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Growth curve ####</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Length_pred_int1.pdf", width=4, height=4)</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Iter.len.day[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">ylab =</span> <span class="st">"Length (mm)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  mass <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.4864</span><span class="sc">*</span>(Iter.len.day[,elev])<span class="sc">-</span><span class="fl">0.7912</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  joule_mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> ED_J_p_mg</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Joule_pred_int1.pdf", width=4, height=4)</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(joule_mass[,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Energy content (J)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Growth-timeseries-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Growth-timeseries-2.png" class="img-fluid" width="384"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Length_pred_int2.pdf", width=4, height=4)</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Iter.len.day[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">ylab =</span> <span class="st">"Length (mm)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  mass <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.4864</span><span class="sc">*</span>(Iter.len.day[,elev])<span class="sc">-</span><span class="fl">0.7912</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  joule_mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> ED_J_p_mg</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Joule_pred_int2.pdf", width=4, height=4)</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(joule_mass[,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), </span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Energy content (J)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#Observed vs.&nbsp;predicted growth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># pdf("Pred_vs_Obs_int1.pdf", width=4, height=4)</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  means_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  means_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  sd_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  sd_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(means_Predlen <span class="sc">~</span> means_Obslen, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"purple"</span>,<span class="st">"black"</span>),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>       <span class="co">#pch = c(15,16,17), for time 2</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="co">#for time 1</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Predicted growth (mm)"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Observed growth (mm)"</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>),<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>))</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen, <span class="at">y0=</span>means_Predlen<span class="sc">-</span>sd_Predlen, <span class="at">x1=</span>means_Obslen, </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen<span class="sc">+</span>sd_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen<span class="sc">-</span>sd_Obslen, <span class="at">y0=</span>means_Predlen, <span class="at">x1=</span>means_Obslen<span class="sc">+</span>sd_Obslen, </span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Predicted%20vs.%20observed%20growth-1.png" class="img-fluid" width="384"></p>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Pred_vs_Obs_int2.pdf", width=4, height=4)</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  means_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  means_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  sd_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  sd_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(means_Predlen <span class="sc">~</span> means_Obslen, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"purple"</span>,<span class="st">"black"</span>),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>       <span class="co">#pch = c(0,1,2), #for time 1</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Predicted growth (mm)"</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Observed growth (mm)"</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>),<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>))</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen, <span class="at">y0=</span>means_Predlen<span class="sc">-</span>sd_Predlen, <span class="at">x1=</span>means_Obslen, </span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen<span class="sc">+</span>sd_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen<span class="sc">-</span>sd_Obslen, <span class="at">y0=</span>means_Predlen, <span class="at">x1=</span>means_Obslen<span class="sc">+</span>sd_Obslen, </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a> <span class="co"># dev.off()</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Physiological rates in terms of day ####</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># new_intake in terms of date ####</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(datetime_int)<span class="sc">/</span><span class="dv">96</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 189.0104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pred_expose_30_dat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(pred_expose_30)[,elev], <span class="at">datetime =</span> datetime_int[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pred_expose_30)])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>intake_dat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(intake_15min_scaled)[elev], <span class="at">datetime =</span> datetime_int[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(intake_15min_scaled)])</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>cost_15min_dat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(cost_15min)[elev], <span class="at">datetime =</span> datetime_int[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cost_15min)])</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_expose_30_dat2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           V4 V110 V147            datetime
1 0.008541651    0    0 2018-02-04 00:00:00
2 0.008515642    0    0 2018-02-04 00:15:00
3 0.008494708    0    0 2018-02-04 00:30:00
4 0.008469010    0    0 2018-02-04 00:45:00
5 0.008458579    0    0 2018-02-04 01:00:00
6 0.008437745    0    0 2018-02-04 01:15:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note 5.2023 - had to swap time 1 vs. time 2</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>new_expose <span class="ot">&lt;-</span> pred_expose_30_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V4),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V2 =</span> <span class="fu">sum</span>(V110),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V3 =</span> <span class="fu">sum</span>(V147))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>new_intake <span class="ot">&lt;-</span> intake_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V4),</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V2 =</span> <span class="fu">sum</span>(V110),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V3 =</span> <span class="fu">sum</span>(V147))</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>new_aq_cost <span class="ot">&lt;-</span> cost_15min_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V4),</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V2 =</span> <span class="fu">sum</span>(V110),</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V3 =</span> <span class="fu">sum</span>(V147))</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  new_expose <span class="ot">&lt;-</span> pred_expose_30_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V36),</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V2 =</span> <span class="fu">sum</span>(V100),</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V3 =</span> <span class="fu">sum</span>(V121))</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  new_intake <span class="ot">&lt;-</span> intake_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V36),</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V2 =</span> <span class="fu">sum</span>(V100),</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V3 =</span> <span class="fu">sum</span>(V121))</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>  new_aq_cost <span class="ot">&lt;-</span> cost_15min_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V36),</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V2 =</span> <span class="fu">sum</span>(V100),</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V3 =</span> <span class="fu">sum</span>(V121))</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>daily_SFG <span class="ot">&lt;-</span> new_intake[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">-</span> new_expose[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">-</span> new_aq_cost[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new_intake) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new_expose) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new_aq_cost) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(daily_SFG) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Don't plot initial and final timepoint, because not a complete timepoint</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>new_intake <span class="ot">&lt;-</span> new_intake[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>new_expose <span class="ot">&lt;-</span> new_expose[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>new_aq_cost <span class="ot">&lt;-</span> new_aq_cost[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>daily_SFG <span class="ot">&lt;-</span> daily_SFG[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(new_intake)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  4
  date       Upper   Mid   Low
  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 2018-08-06  1.75  2.01  2.13
2 2018-08-07  2.42  2.29  2.13
3 2018-08-08  3.27  2.31  2.10
4 2018-08-09  4.21  2.35  2.08
5 2018-08-10  4.45  2.42  2.12
6 2018-08-11  0     0     0   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_intake)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  4
  date       Upper   Mid   Low
  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 2018-02-05 0.810 0.879 0.766
2 2018-02-06 0.773 0.627 0.720
3 2018-02-07 0.695 0.570 0.812
4 2018-02-08 0.861 1.13  0.849
5 2018-02-09 0.450 1.11  0.839
6 2018-02-10 0     1.09  0.813</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(new_intake)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 188   4</code></pre>
</div>
</div>
<p>Plot physiological rates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_physiological_rates_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, new_intake<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_aq_cost<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_expose<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Intake"</span>, <span class="st">"Aquatic cost"</span>, <span class="st">"Aerial cost"</span>),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"darkslategray"</span>, <span class="st">"blue"</span>, <span class="st">"darkorchid4"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, new_intake<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate</span><span class="sc">\n</span><span class="st"> (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_aq_cost<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_expose<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, new_intake<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_aq_cost<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_expose<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Physio-timeseries-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_physiological_rates_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, new_intake<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_aq_cost<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_expose<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Intake"</span>, <span class="st">"Aquatic cost"</span>, <span class="st">"Aerial cost"</span>),</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"darkslategray"</span>, <span class="st">"blue"</span>, <span class="st">"darkorchid4"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, new_intake<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate</span><span class="sc">\n</span><span class="st"> (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_aq_cost<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_expose<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, new_intake<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_aq_cost<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date, new_expose<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot Scope for Growth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_SFG_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(daily_SFG)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Scope for Growth"</span>),</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/SFG-timeseries-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_SFG_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(daily_SFG)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Scope for Growth"</span>),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>New plot that overlays cumulative SFG (5/4/23)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("daily_SFG_int_cumulative.pdf", width=6.5, height=1.5, units = "in")</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(new_intake<span class="sc">$</span>date)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(joule_mass)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>new.joule_mass <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(joule_mass, <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="dv">1</span>], x[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">1</span>])))</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,]</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">60</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Daily SFG"</span>, <span class="st">"Cumulative SFG"</span>),</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">60</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">60</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>) </span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   189 obs. of  3 variables:
 $ V4  : num  39 39.1 39.1 39.2 39.1 ...
 $ V110: num  43.1 43.2 43.3 43.3 43.2 ...
 $ V147: num  36.1 36.3 36.5 36.6 36.9 ...</code></pre>
</div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/SFG-timeseries-cumulative-overlay-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># pdf("daily_SFG_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pngfile &lt;- fs::path(knitr::fig_path(),  "scaling.png")</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># agg_png(pngfile, width = 6.5, height = 1.5, units = "in", res = 300, scaling = 3)</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(p)</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># invisible(dev.off())</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::include_graphics(pngfile)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_SFG_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(new_intake<span class="sc">$</span>date)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(joule_mass)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>new.joule_mass <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(joule_mass, <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="dv">1</span>], x[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">1</span>])))</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,]</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">60</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Daily SFG"</span>, <span class="st">"Cumulative SFG"</span>),</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">60</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span><span class="dv">189</span>,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">60</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>) </span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc daily air and water temp ####</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Look to see if/where data is missing</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp<span class="fl">.2</span><span class="sc">$</span>datetime,air.temp<span class="fl">.2</span><span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2018-08-10"</span>),<span class="fu">as.POSIXct</span>(<span class="st">"2018-12-01"</span>)))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp<span class="fl">.2</span><span class="sc">$</span>datetime,water.temp<span class="fl">.2</span><span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2018-08-10"</span>),<span class="fu">as.POSIXct</span>(<span class="st">"2018-11-01"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aug 22 - Aug 25</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  air.temp.int <span class="ot">&lt;-</span> air.temp<span class="fl">.1</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  water.temp.int <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>air.temp.int <span class="ot">&lt;-</span> air.temp<span class="fl">.2</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>water.temp.int <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>daily_air_temp <span class="ot">&lt;-</span> air.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">mean</span>(Low,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">mean</span>(Mid,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">mean</span>(Upper,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>daily_air_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 190  4
   date         Low   Mid Upper
   &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2018-02-04  8.62 11.6   9.88
 2 2018-02-05  8.09  9.51  9.28
 3 2018-02-06  7.90  8.01  8.00
 4 2018-02-07  7.93  7.93  7.89
 5 2018-02-08 10.1  11.1  10.1 
 6 2018-02-09 11.0  11.4   9.14
 7 2018-02-10  6.78  8.21  7.92
 8 2018-02-11  6.06  7.45  9.11
 9 2018-02-12  5.37  6.89  9.08
10 2018-02-13  3.98  6.12  7.54
#  with 180 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>daily_water_temp <span class="ot">&lt;-</span> water.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">mean</span>(Low,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">mean</span>(Mid,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">mean</span>(Upper,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Upper 75% quantile ####</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co">#A quartile is the value of the quantile at the probabilities 0.25, 0.5 and 0.75.</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/26532566/quantile-vs-quartile-in-lay-terms</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant <span class="ot">&lt;-</span> air.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">quantile</span>(Low, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">quantile</span>(Mid, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">quantile</span>(Upper, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant_low <span class="ot">&lt;-</span> air.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">quantile</span>(Low, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">quantile</span>(Mid, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">quantile</span>(Upper, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>daily_air_temp <span class="ot">&lt;-</span> daily_air_temp[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>daily_water_temp <span class="ot">&lt;-</span> daily_water_temp[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant <span class="ot">&lt;-</span> daily_air_temp_quant[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant_low <span class="ot">&lt;-</span> daily_air_temp_quant_low[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot temp, 6.5X1.5 ####</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Note dimensions must be called within pdf() - also saving as a .pdf through th GUI is broken. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temp_incl_3Q.pdf", width=6.5, height=1.5)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(daily_air_temp<span class="sc">$</span>Mid, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.574233</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temp ("</span>,degree,<span class="st">"C)"</span>)), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temp_incl_3Q.pdf", width=6.5, height=1.5)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(daily_air_temp<span class="sc">$</span>Mid, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.574233</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temp ("</span>,degree,<span class="st">"C)"</span>)), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temp_legend_incl_3Q.pdf", width=6.5, height=1.5)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span> ,<span class="at">xaxt=</span><span class="st">'n'</span>,<span class="at">yaxt=</span><span class="st">'n'</span>,<span class="at">bty=</span><span class="st">'n'</span>,<span class="at">ylab=</span><span class="st">''</span>,<span class="at">xlab=</span><span class="st">''</span>, <span class="at">xlim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"75%-ile low tide temp"</span>, <span class="st">"Low tide temp"</span>,  <span class="st">"Water temp"</span>),</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span><span class="fu">c</span>(<span class="st">"darkred"</span>,<span class="st">"darkorchid4"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  air.temp.interval <span class="ot">&lt;-</span> air.temp<span class="fl">.1</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  water.temp.interval <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  food.int <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span><span class="sc">$</span>food</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  datetime.int <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span><span class="sc">$</span>datetime</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  air.temp.interval <span class="ot">&lt;-</span> air.temp<span class="fl">.2</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  water.temp.interval <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  food.int <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span><span class="sc">$</span>food</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  datetime.int <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span><span class="sc">$</span>datetime</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>air.temp.day <span class="ot">&lt;-</span> <span class="fu">cbind</span>(air.temp.interval,<span class="at">day =</span> <span class="fu">yday</span>(air.temp.interval<span class="sc">$</span>datetime))</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>air.temp_count_U <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp.day[,<span class="st">"Upper"</span>]),air.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>air.temp_count_M <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp.day[,<span class="st">"Mid"</span>]),air.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>air.temp_count_L <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp.day[,<span class="st">"Low"</span>]),air.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>air.temp.count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> air.temp_count_U,</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mid =</span> air.temp_count_M,</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Low =</span> air.temp_count_L</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>water.temp.day <span class="ot">&lt;-</span> <span class="fu">cbind</span>(water.temp.interval,<span class="at">day =</span> <span class="fu">yday</span>(water.temp.interval<span class="sc">$</span>datetime))</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>water.temp_count_U <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(water.temp.day[,<span class="st">"Upper"</span>]),water.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>water.temp_count_M <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(water.temp.day[,<span class="st">"Mid"</span>]),water.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>water.temp_count_L <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(water.temp.day[,<span class="st">"Low"</span>]),water.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>water.temp.count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> water.temp_count_U,</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mid =</span> water.temp_count_M,</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Low =</span> water.temp_count_L</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(water.temp.count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   190 obs. of  3 variables:
 $ Upper: int  21 20 19 17 21 11 0 36 13 14 ...
 $ Mid  : int  49 45 32 29 57 56 55 57 56 54 ...
 $ Low  : int  65 62 58 65 67 66 64 63 62 61 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>water.temp.count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Upper Mid Low
35     21  49  65
36     20  45  62
37     19  32  58
38     17  29  65
39     21  57  67
40     11  56  66
41      0  55  64
42     36  57  63
43     13  56  62
44     14  54  61
45     20  56  63
46     13  44  62
47     13  45  62
48     23  59  65
49     28  42  60
50     12  35  49
51     13  29  51
52     10  23  49
53     12  24  58
54     11  29  64
55     18  55  64
56     46  58  65
57     26  58  65
58     32  58  61
59     32  57  63
60     35  62  67
61     31  53  68
62     28  44  60
63     25  42  54
64     15  41  54
65     14  38  57
66     12  40  66
67     17  63  72
68     32  63  72
69     12  59  68
70     17  57  67
71     18  58  67
72     27  63  66
73     22  60  68
74     26  60  68
75     23  50  71
76     20  45  68
77     22  42  56
78     13  39  53
79     14  43  57
80     22  48  74
81     35  67  73
82     37  64  71
83     53  62  69
84     40  60  68
85     25  60  67
86     21  61  68
87     17  42  65
88     14  36  53
89     14  35  51
90     11  33  49
91     14  38  52
92     22  43  54
93     16  42  62
94     16  46  68
95     18  60  68
96     19  60  68
97     43  63  71
98     36  61  71
99     18  39  66
100    23  61  71
101    20  59  71
102    20  46  74
103    14  35  57
104    13  36  54
105    15  41  58
106    29  47  72
107    27  47  67
108    21  46  67
109    24  52  65
110    24  58  64
111    34  58  64
112    20  54  62
113    18  34  62
114    17  29  65
115    17  27  59
116    17  40  53
117    18  37  55
118    16  40  57
119    22  42  62
120    24  44  66
121    24  50  64
122    24  59  65
123    24  58  65
124    20  55  64
125    18  54  62
126    23  54  63
127    22  44  63
128    21  37  66
129    22  35  70
130    18  30  59
131    15  26  50
132    12  29  47
133    16  37  57
134    16  44  66
135    28  54  65
136    36  60  64
137    40  61  64
138    49  59  65
139    46  59  65
140    35  58  65
141    23  56  63
142    22  33  66
143    20  30  58
144    20  29  54
145    17  35  49
146    16  34  58
147    13  40  64
148    13  51  63
149    21  56  63
150    26  57  62
151    36  59  63
152    30  57  64
153    19  55  63
154    21  55  62
155    22  53  63
156    21  41  64
157    21  34  65
158    20  32  55
159    18  29  56
160    19  33  56
161    19  38  66
162    18  45  63
163    19  57  63
164    39  58  62
165    49  57  61
166    53  59  63
167    46  60  64
168    36  60  64
169    23  59  66
170    23  47  67
171    21  30  60
172    22  30  54
173    19  29  55
174    18  37  64
175    17  43  63
176    22  55  62
177    22  54  60
178    29  55  62
179    40  56  62
180    37  57  62
181    29  57  63
182    20  57  64
183    19  55  63
184    16  42  63
185    19  32  66
186    20  31  70
187    20  30  55
188    20  30  62
189    19  41  65
190    23  52  63
191    25  55  62
192    31  55  60
193    43  56  61
194    52  57  61
195    47  59  62
196    43  61  65
197    33  62  67
198    21  51  68
199    20  32  62
200    20  28  54
201    19  28  59
202    18  39  60
203    16  41  62
204    19  54  62
205    30  56  63
206    36  55  62
207    36  55  62
208    37  57  63
209    36  57  63
210    26  59  63
211    17  59  65
212    18  60  67
213    18  45  68
214    17  34  70
215    16  26  56
216    16  27  59
217    19  38  65
218    20  48  62
219    28  55  62
220    38  56  62
221    49  57  62
222    51  59  63
223    45  59  63
224     0   1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>water.temp.count<span class="sc">$</span>Upper[<span class="fu">is.nan</span>(water.temp.count<span class="sc">$</span>Upper)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>water.temp.count<span class="sc">$</span>Mid[<span class="fu">is.nan</span>(water.temp.count<span class="sc">$</span>Mid)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>water.temp.count<span class="sc">$</span>Low[<span class="fu">is.nan</span>(water.temp.count<span class="sc">$</span>Low)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>air.temp.count<span class="sc">$</span>Low[<span class="fu">is.nan</span>(air.temp.count<span class="sc">$</span>Low)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>air.temp.count<span class="sc">$</span>Mid[<span class="fu">is.nan</span>(air.temp.count<span class="sc">$</span>Mid)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>air.temp.count<span class="sc">$</span>Upper[<span class="fu">is.nan</span>(air.temp.count<span class="sc">$</span>Upper)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>time.submerged <span class="ot">&lt;-</span> water.temp.count <span class="sc">/</span> (water.temp.count <span class="sc">+</span> air.temp.count)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># time.submerged[water.temp.count$Upper&lt;=10 |air.temp.count$Upper&lt;=18,"Upper"]&lt;- NA #Wow - actually there is one day with &lt;10 intervals submerged - that is 2.5 hours.</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co"># time.submerged[water.temp.count$Mid&lt;=10 |air.temp.count$Mid&lt;=18,"Mid"]&lt;- NA</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># time.submerged[water.temp.count$Low&lt;=10 |air.temp.count$Low&lt;=18,"Low"]&lt;- NA</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>time.submerged[water.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>air.temp.count<span class="sc">$</span>Upper<span class="sc">&lt;=</span><span class="dv">95</span>,<span class="st">"Upper"</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>time.submerged[water.temp.count<span class="sc">$</span>Mid<span class="sc">+</span>air.temp.count<span class="sc">$</span>Mid<span class="sc">&lt;=</span><span class="dv">95</span>,<span class="st">"Mid"</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>time.submerged[water.temp.count<span class="sc">$</span>Low<span class="sc">+</span>air.temp.count<span class="sc">$</span>Low<span class="sc">&lt;=</span><span class="dv">95</span>,<span class="st">"Low"</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time.submerged<span class="sc">$</span>Low, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'l'</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">180</span>,<span class="dv">200</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">195</span>,<span class="dv">200</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-26-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot time submerged, pretty version LMU, 6.5X1.5 dim ####</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Documents/GitHub/Bglandula_FHL_energetics/plots")</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("submergence_time2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, time.submerged<span class="sc">$</span>Low[<span class="dv">2</span><span class="sc">:</span>cutoff],<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.Date</span>(water.temp.int<span class="sc">$</span>datetime), food.int<span class="sc">/</span>(food.int<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co">#axis(side = 4, at = pretty(range(c(0,1))))      # Add second axis</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"bottomleft"</span>,</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Food availability"</span>,<span class="st">"Time submerged"</span>),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, time.submerged<span class="sc">$</span>Mid[<span class="dv">2</span><span class="sc">:</span>cutoff],<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.Date</span>(water.temp.int<span class="sc">$</span>datetime), food.int<span class="sc">/</span>(food.int<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>)</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a><span class="co">#axis(side = 4, at = pretty(range(c(0,1))))      # Add second axis</span></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, time.submerged<span class="sc">$</span>Upper[<span class="dv">2</span><span class="sc">:</span>cutoff],<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.Date</span>(water.temp.int<span class="sc">$</span>datetime), food.int<span class="sc">/</span>(food.int<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>)</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">at =</span> <span class="fu">pretty</span>(<span class="fu">range</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))))      <span class="co"># Add second axis</span></span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Food availability (unitless)"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot food over time ####</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1 and 2")</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("Food availability over time_int1and2.pdf", width=6.5*1.5, height=1.5*1.5)</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mar = c(5, 4, 4, 5) + 0.3)              # Additional space for second y-axis</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(x, y1, pch = 16, col = 2)              # Create first plot</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># par(new = TRUE)                             # Add new plot</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(x, y2, pch = 17, col = 3,              # Create second plot without axes</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co">#      axes = FALSE, xlab = "", ylab = "")</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis(side = 4, at = pretty(range(y2)))      # Add second axis</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mtext("y2", side = 4, line = 3)  </span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.1</span><span class="sc">$</span>datetime, food.list[[<span class="dv">1</span>]]<span class="sc">/</span>(food.list[[<span class="dv">1</span>]]<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>, <span class="at">xlab =</span> <span class="st">""</span>)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.1</span><span class="sc">$</span>datetime, food.list[[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">axes =</span> <span class="cn">FALSE</span>,  <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">lty =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">""</span>)                           <span class="co"># Add new plot</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">at =</span> <span class="fu">pretty</span>(<span class="fu">range</span>(food.list[[<span class="dv">1</span>]])))      <span class="co"># Add second axis</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"ug / L Chl"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)  </span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.2</span><span class="sc">$</span>datetime, food.list[[<span class="dv">2</span>]]<span class="sc">/</span>(food.list[[<span class="dv">2</span>]]<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>)</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.2</span><span class="sc">$</span>datetime, food.list[[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),  <span class="at">axes =</span> <span class="cn">FALSE</span>,<span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">""</span>)</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">at =</span> <span class="fu">pretty</span>(<span class="fu">range</span>(food.list[[<span class="dv">1</span>]])))      <span class="co"># Add second axis</span></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"ug / L Chl"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>