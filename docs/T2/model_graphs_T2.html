<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>model_graphs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="model_graphs_files/libs/clipboard/clipboard.min.js"></script>
<script src="model_graphs_files/libs/quarto-html/quarto.js"></script>
<script src="model_graphs_files/libs/quarto-html/popper.min.js"></script>
<script src="model_graphs_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="model_graphs_files/libs/quarto-html/anchor.min.js"></script>
<link href="model_graphs_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="model_graphs_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="model_graphs_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="model_graphs_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="model_graphs_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">model_graphs</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="set-up-workspace" class="level2">
<h2 class="anchored" data-anchor-id="set-up-workspace">Set up workspace</h2>
</section>
<section id="set-the-interval-for-single-interval-plots" class="level2">
<h2 class="anchored" data-anchor-id="set-the-interval-for-single-interval-plots">Set the interval for single interval plots</h2>
<p>Time 1 is from February to August. Time 2 is from August to February.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>timing <span class="ot">&lt;-</span> params<span class="sc">$</span>time_interval</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Documents/GitHub/Bglandula_FHL_energetics/code/save_workspace"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"my_work_space_time1_20210409.RData"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  timing <span class="ot">&lt;-</span> <span class="dv">1</span>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"my_work_space_time2_20210409.RData"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  timing <span class="ot">&lt;-</span> <span class="dv">2</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate average barnacle sizes (length, cm)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(Iter.len<span class="fl">.2</span>[<span class="dv">1</span>,])) <span class="co">#0.23</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2319636</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(Iter.len<span class="fl">.1</span>[<span class="dv">1</span>,])) <span class="co">#0.22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2171867</code></pre>
</div>
</div>
<p>Pick representative barnacles that are close to these sizes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.1[1,Iter.len.1[1,]&gt;=.215&amp;Iter.len.1[1,]&lt;=.235] #V27 is .222, V110 is .220, V143 is .229</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.1[1, Elevation.list[[1]]=="Mid"]#108-143 </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.1[1, Elevation.list[[1]]=="Low"]#</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Iter.len.2[1,]&gt;=.205&amp;Iter.len.2[1,]&lt;=.235]</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1, Elevation.list[[2]]=="Upper"]#1-92 - V1 is 0.205, V32 is 0.221</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1, Elevation.list[[2]]=="Mid"]#93-108 - V94 is 0.20, V100 is 0.23</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1, Elevation.list[[2]]=="Low"]#109-138 - V124 is 0.209, V121 is 0.225</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Iter.len.2[1,Elevation.list[[2]]=="Mid"]&gt;=.20&amp;Iter.len.2[1,Elevation.list[[2]]=="Mid"]&lt;=.225] #V114 is 0.222</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Iter.len.2[1,Elevation.list[[2]]=="Low"]&gt;=.225&amp;Iter.len.2[1,Elevation.list[[2]]=="Low"]&lt;=.23]</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Elevation.list[[2]]=="Mid"]</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Iter.len.2[1,Elevation.list[[2]]=="Low"]</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Set representative barnacles ####</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">110</span>,<span class="dv">147</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  elev<span class="fl">.1</span> <span class="ot">&lt;-</span> elev</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">36</span>,<span class="dv">100</span>,<span class="dv">121</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  elev<span class="fl">.2</span> <span class="ot">&lt;-</span> elev</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> elev<span class="fl">.1</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  datetime_int <span class="ot">&lt;-</span> datetimes[[<span class="dv">1</span>]]</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  Iter.len<span class="fl">.1</span>[<span class="dv">1</span>,elev] <span class="co">#0.21, 0.22, 0.20</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  cutoff <span class="ot">&lt;-</span> <span class="dv">189</span> <span class="co">#This should be 188 or 189 but maybe I'm cutting off points twice? </span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Iter.len<span class="fl">.1</span>[,elev[<span class="dv">1</span>]])<span class="sc">/</span><span class="dv">96</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  elev <span class="ot">&lt;-</span> elev<span class="fl">.2</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  datetime_int <span class="ot">&lt;-</span> datetimes[[<span class="dv">2</span>]]</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Iter.len<span class="fl">.2</span>[,elev[<span class="dv">1</span>]])<span class="sc">/</span><span class="dv">96</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  cutoff <span class="ot">&lt;-</span> <span class="dv">186</span> <span class="co">#This should be 198 - we are missing 8 days?</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cutoff &lt;- 196</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(Iter.len<span class="fl">.2</span>[,elev]) <span class="co">#V95 (mid) was a little small, but changed rep barnacles in beginning of April</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        V36      V100     V121
1 0.2298567 0.2302311 0.225676
2 0.0000000 0.0000000 0.000000
3 0.0000000 0.0000000 0.000000
4 0.0000000 0.0000000 0.000000
5 0.0000000 0.0000000 0.000000
6 0.0000000 0.0000000 0.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Elev.abbrev.list <span class="ot">&lt;-</span> <span class="fu">list</span>(elev<span class="fl">.1</span>, elev<span class="fl">.2</span>) <span class="co">#Need to run timing 1 and 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary statistics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Upper emergence time</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>no.na.water <span class="ot">&lt;-</span> water.temp[<span class="sc">!</span><span class="fu">is.na</span>(water.temp[,<span class="dv">2</span>]),<span class="dv">2</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>no.na.air <span class="ot">&lt;-</span> air.temp[<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">2</span>]),<span class="dv">2</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(no.na.air)<span class="sc">/</span>(<span class="fu">length</span>(no.na.water)<span class="sc">+</span><span class="fu">length</span>(no.na.air))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72.18116</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mid emergence time</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>no.na.water <span class="ot">&lt;-</span> water.temp[<span class="sc">!</span><span class="fu">is.na</span>(water.temp[,<span class="dv">3</span>]),<span class="dv">3</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>no.na.air <span class="ot">&lt;-</span> air.temp[<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">3</span>]),<span class="dv">3</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(no.na.air)<span class="sc">/</span>(<span class="fu">length</span>(no.na.water)<span class="sc">+</span><span class="fu">length</span>(no.na.air))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.00277</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lower emergence time</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>no.na.water <span class="ot">&lt;-</span> water.temp[<span class="sc">!</span><span class="fu">is.na</span>(water.temp[,<span class="dv">4</span>]),<span class="dv">4</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>no.na.air <span class="ot">&lt;-</span> air.temp[<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">4</span>]),<span class="dv">4</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(no.na.air)<span class="sc">/</span>(<span class="fu">length</span>(no.na.water)<span class="sc">+</span><span class="fu">length</span>(no.na.air))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33.41369</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>air.temp[<span class="fu">max</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">2</span>])),<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-08-07 01:00:00 GMT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>air.temp[<span class="fu">min</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp[,<span class="dv">2</span>])),<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#max(no.na.air)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#min(no.na.water)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Temp graphs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temps_15_min_int1and2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp[,<span class="dv">4</span>], <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>), <span class="at">ylab =</span> <span class="st">"Temperature deg C"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp[,<span class="dv">4</span>],  <span class="at">pch =</span> <span class="st">"."</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Low"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp[,<span class="dv">3</span>], <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>), <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp[,<span class="dv">3</span>],  <span class="at">pch =</span> <span class="st">"."</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Mid"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#points(intake_15min_scaled[,2], col = "green", pch = ".")</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>), <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp[,<span class="dv">2</span>],  <span class="at">pch =</span> <span class="st">"."</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#points(intake_15min_scaled[,3], col = "green", pch = ".")</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert from UCT to PST</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(datetime_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018-08-15 GMT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(datetime_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019-03-01 GMT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(datetime_int<span class="sc">&gt;=</span><span class="fu">as.POSIXct</span>(<span class="st">"2018-08-01 00:00:00"</span>)<span class="sc">&amp;</span>datetime_int<span class="sc">&lt;=</span><span class="fu">as.POSIXct</span>(<span class="st">"2018-08-02 00:00:00"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>conv <span class="ot">&lt;-</span> <span class="dv">17105</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#i_seq &lt;- 100</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Iter.air)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19009   138</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#And then again last day (repeat)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>i_seq <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> ts<span class="sc">*</span>(i_seq<span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> i<span class="sc">+</span>ts<span class="dv">-1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>temp_i.w <span class="ot">&lt;-</span> Iter.water[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>temp_i.a <span class="ot">&lt;-</span> Iter.air[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>food_i <span class="ot">&lt;-</span> Iter.food[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv)]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>cost_15min_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cost_15min[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),])</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>intake_15min_scaled_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(intake_15min_scaled[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),])</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>pred_expose_30_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_expose_30[(i<span class="sc">+</span>conv)<span class="sc">:</span>(j<span class="sc">+</span>conv),])</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>Hour <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="at">to =</span> <span class="dv">96</span><span class="sc">*</span><span class="dv">15</span>, <span class="at">by =</span> <span class="dv">15</span>)<span class="sc">/</span><span class="dv">60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("within_day_rates_15_min_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>),<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>),<span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_rates_15_min_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),<span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a> <span class="co"># setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries1_temp-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Physiological rates over 1 day, end ####</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This isn't computing for both beginning and end separately I don't think. </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#i_seq &lt;- 100</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Iter.air)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19009   138</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#And then again last day (repeat)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>i_seq <span class="ot">&lt;-</span> end</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> ts<span class="sc">*</span>(i_seq<span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> i<span class="sc">+</span>ts<span class="dv">-1</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>temp_i.w <span class="ot">&lt;-</span> Iter.water[i<span class="sc">:</span>j,]</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>temp_i.a <span class="ot">&lt;-</span> Iter.air[i<span class="sc">:</span>j,]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>food_i <span class="ot">&lt;-</span> Iter.food[i<span class="sc">:</span>j]</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>cost_15min_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cost_15min[i<span class="sc">:</span>j,])</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>intake_15min_scaled_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(intake_15min_scaled[i<span class="sc">:</span>j,])</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>pred_expose_30_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_expose_30[i<span class="sc">:</span>j,])</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>Hour <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="at">to =</span> <span class="dv">96</span><span class="sc">*</span><span class="dv">15</span>, <span class="at">by =</span> <span class="dv">15</span>)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_rates_15_min_int1_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">col =</span> <span class="st">"blue"</span>,)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_rates_15_min_int2_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">3</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"Physiological Rate (J per 15min)"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,cost_15min_dat[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>),</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">col =</span> <span class="st">"blue"</span>,)</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,intake_15min_scaled_dat[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,pred_expose_30_dat[, elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries2_physio-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int1_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span><span class="st">"darkorchid4"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a> <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("within_day_temps_15min_int2_end.pdf", width=6.5, height=1.5)</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">3</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">"Temp"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">2</span>]],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Hour,temp_i.a[,elev[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">30</span>),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(Hour,temp_i.w[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/1-day%20timeseries2_temp-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<p>Growth curve</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Growth curve ####</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Length_pred_int1.pdf", width=4, height=4)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Iter.len.day[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">ylab =</span> <span class="st">"Length (mm)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  mass <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.4864</span><span class="sc">*</span>(Iter.len.day[,elev])<span class="sc">-</span><span class="fl">0.7912</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  joule_mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> ED_J_p_mg</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Joule_pred_int1.pdf", width=4, height=4)</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(joule_mass[,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Energy content (J)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Length_pred_int2.pdf", width=4, height=4)</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Iter.len.day[,elev[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">ylab =</span> <span class="st">"Length (mm)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(Iter.len.day[,elev[<span class="dv">3</span>]], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  mass <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.4864</span><span class="sc">*</span>(Iter.len.day[,elev])<span class="sc">-</span><span class="fl">0.7912</span>)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  joule_mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> ED_J_p_mg</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Joule_pred_int2.pdf", width=4, height=4)</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(matrix(seq(1, length(Iter.len.day), by = 1), nrow = length(Iter.len.day), ncol = Iter.len.day[,names(temp_i.a)=="Upper"]),Iter.len.day[,names(temp_i.a)=="Upper"], ylim = c(0,5), pch = ".", ylab = "Length (mm)", xlab = "Day") #Upper</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(joule_mass[,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">"l"</span>, </span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), </span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Energy content (J)"</span>, <span class="at">xlab =</span> <span class="st">"Day"</span>) <span class="co">#Upper</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"purple"</span>) <span class="co">#Mid</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(joule_mass[,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"orange"</span>) <span class="co">#Low</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Growth-timeseries-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Growth-timeseries-2.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>#Observed vs.&nbsp;predicted growth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># pdf("Pred_vs_Obs_int1.pdf", width=4, height=4)</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  means_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  means_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  sd_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  sd_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(means_Predlen <span class="sc">~</span> means_Obslen, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"purple"</span>,<span class="st">"black"</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>       <span class="co">#pch = c(15,16,17), for time 2</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="co">#for time 1</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Predicted growth (mm)"</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Observed growth (mm)"</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>),<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>))</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen, <span class="at">y0=</span>means_Predlen<span class="sc">-</span>sd_Predlen, <span class="at">x1=</span>means_Obslen, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen<span class="sc">+</span>sd_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen<span class="sc">-</span>sd_Obslen, <span class="at">y0=</span>means_Predlen, <span class="at">x1=</span>means_Obslen<span class="sc">+</span>sd_Obslen, </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("Pred_vs_Obs_int2.pdf", width=4, height=4)</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  means_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  means_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), mean)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  sd_Obslen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(obs.growth.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  sd_Predlen <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pred.len, <span class="fu">as.factor</span>(Elevation), sd)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(means_Predlen <span class="sc">~</span> means_Obslen, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), </span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"purple"</span>,<span class="st">"black"</span>),</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>),</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>       <span class="co">#pch = c(0,1,2), #for time 1</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Predicted growth (mm)"</span>,</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Observed growth (mm)"</span>)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>),<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">2.5</span>))</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen, <span class="at">y0=</span>means_Predlen<span class="sc">-</span>sd_Predlen, <span class="at">x1=</span>means_Obslen, </span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen<span class="sc">+</span>sd_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="at">x0=</span>means_Obslen<span class="sc">-</span>sd_Obslen, <span class="at">y0=</span>means_Predlen, <span class="at">x1=</span>means_Obslen<span class="sc">+</span>sd_Obslen, </span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>means_Predlen, <span class="at">code=</span><span class="dv">0</span>)</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a> <span class="co"># dev.off()</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Predicted%20vs.%20observed%20growth-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Physiological rates in terms of day ####</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># new_intake in terms of date ####</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(datetime_int)<span class="sc">/</span><span class="dv">96</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 198.0104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pred_expose_30_dat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(pred_expose_30)[,elev], <span class="at">datetime =</span> datetime_int[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pred_expose_30)])</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>intake_dat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(intake_15min_scaled)[elev], <span class="at">datetime =</span> datetime_int[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(intake_15min_scaled)])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>cost_15min_dat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(cost_15min)[elev], <span class="at">datetime =</span> datetime_int[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cost_15min)])</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_expose_30_dat2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         V36       V100       V121            datetime
1 0.03059254 0.03844741 0.02023924 2018-08-15 00:00:00
2 0.03109187 0.03504062 0.01353497 2018-08-15 00:15:00
3 0.02960886 0.03334050 0.00000000 2018-08-15 00:30:00
4 0.02944493 0.01498776 0.00000000 2018-08-15 00:45:00
5 0.02852466 0.01378417 0.00000000 2018-08-15 01:00:00
6 0.02730871 0.00000000 0.00000000 2018-08-15 01:15:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note 5.2023 - had to swap time 1 vs. time 2</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>new_expose <span class="ot">&lt;-</span> pred_expose_30_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V4),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V2 =</span> <span class="fu">sum</span>(V110),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V3 =</span> <span class="fu">sum</span>(V147))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>new_intake <span class="ot">&lt;-</span> intake_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V4),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V2 =</span> <span class="fu">sum</span>(V110),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V3 =</span> <span class="fu">sum</span>(V147))</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>new_aq_cost <span class="ot">&lt;-</span> cost_15min_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V4),</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V2 =</span> <span class="fu">sum</span>(V110),</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">V3 =</span> <span class="fu">sum</span>(V147))</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  new_expose <span class="ot">&lt;-</span> pred_expose_30_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V36),</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V2 =</span> <span class="fu">sum</span>(V100),</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V3 =</span> <span class="fu">sum</span>(V121))</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  new_intake <span class="ot">&lt;-</span> intake_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V36),</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V2 =</span> <span class="fu">sum</span>(V100),</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V3 =</span> <span class="fu">sum</span>(V121))</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  new_aq_cost <span class="ot">&lt;-</span> cost_15min_dat2 <span class="sc">%&gt;%</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">V1 =</span> <span class="fu">sum</span>(V36),</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V2 =</span> <span class="fu">sum</span>(V100),</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">V3 =</span> <span class="fu">sum</span>(V121))</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  198 failed to parse.
There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  198 failed to parse.
There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  198 failed to parse.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>daily_SFG <span class="ot">&lt;-</span> new_intake[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">-</span> new_expose[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">-</span> new_aq_cost[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new_intake) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new_expose) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new_aq_cost) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(daily_SFG) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Upper"</span>, <span class="st">"Mid"</span>, <span class="st">"Low"</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Don't plot initial and final timepoint, because not a complete timepoint</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>new_intake <span class="ot">&lt;-</span> new_intake[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>new_expose <span class="ot">&lt;-</span> new_expose[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>new_aq_cost <span class="ot">&lt;-</span> new_aq_cost[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>daily_SFG <span class="ot">&lt;-</span> daily_SFG[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(new_intake)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  date       Upper   Mid   Low
  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 2019-02-11  1.07  1.46  1.85
2 2019-02-12  1.29  1.74  1.94
3 2019-02-13  1.59  2.06  1.93
4 2019-02-14  2.95  2.05  1.84
5 2019-02-15  3.13  2.05  1.81
6 2019-02-16  3.14  2.02  1.70</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_intake)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  date       Upper   Mid   Low
  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 2018-08-16 1.00  1.11   1.20
2 2018-08-17 0.898 0.929  1.24
3 2018-08-18 0.877 1.25   1.40
4 2018-08-19 0.877 1.48   1.42
5 2018-08-20 1.18  1.70   1.46
6 2018-08-21 1.35  1.78   1.53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(new_intake)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 185   4</code></pre>
</div>
</div>
<p>Plot physiological rates over time</p>
<p>Set axes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>  df_round<span class="ot">&lt;-</span>new_intake <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">modified_df =</span> <span class="fu">round_date</span>(date, <span class="at">unit=</span><span class="st">"month"</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  df_round <span class="ot">&lt;-</span> df_round<span class="sc">$</span>modified_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a> n_len <span class="ot">&lt;-</span> <span class="fu">length</span>(new_intake<span class="sc">$</span>Low)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_physiological_rates_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_intake<span class="sc">$</span>Low[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_aq_cost<span class="sc">$</span>Low[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_expose<span class="sc">$</span>Low[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Intake"</span>, <span class="st">"Aquatic cost"</span>, <span class="st">"Aerial cost"</span>),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"darkslategray"</span>, <span class="st">"blue"</span>, <span class="st">"darkorchid4"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_intake<span class="sc">$</span>Mid[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate</span><span class="sc">\n</span><span class="st"> (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_aq_cost<span class="sc">$</span>Mid[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_expose<span class="sc">$</span>Mid[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_intake<span class="sc">$</span>Upper[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_aq_cost<span class="sc">$</span>Upper[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_expose<span class="sc">$</span>Upper[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_physiological_rates_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_intake<span class="sc">$</span>Low[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_aq_cost<span class="sc">$</span>Low[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_expose<span class="sc">$</span>Low[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Intake"</span>, <span class="st">"Aquatic cost"</span>, <span class="st">"Aerial cost"</span>),</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"darkslategray"</span>, <span class="st">"blue"</span>, <span class="st">"darkorchid4"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_intake<span class="sc">$</span>Mid[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate</span><span class="sc">\n</span><span class="st"> (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_aq_cost<span class="sc">$</span>Mid[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_expose<span class="sc">$</span>Mid[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_intake<span class="sc">$</span>Upper[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkslategray"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_aq_cost<span class="sc">$</span>Upper[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(new_intake<span class="sc">$</span>date[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], new_expose<span class="sc">$</span>Upper[<span class="dv">1</span><span class="sc">:</span>n_len<span class="dv">-1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/Physio-timeseries-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<p>Plot Scope for Growth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_SFG_int1.pdf", width=6.5, height=1.5)</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(daily_SFG)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Scope for Growth"</span>),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_x_date(date_breaks="1 month", date_labels="%m")</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_SFG_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(daily_SFG)</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Scope for Growth"</span>),</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">9</span>,<span class="fl">4.5</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/SFG-timeseries-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<p>New plot that overlays cumulative SFG (5/4/23)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("daily_SFG_int_cumulative.pdf", width=6.5, height=1.5, units = "in")</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>n_dates <span class="ot">&lt;-</span> <span class="fu">length</span>(new_intake<span class="sc">$</span>date)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(joule_mass)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>new.joule_mass <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(joule_mass, <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="dv">1</span>], x[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">1</span>])))</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span>n_dates,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">70</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Daily SFG"</span>, <span class="st">"Cumulative SFG"</span>),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span>n_dates,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">70</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span>n_dates,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">70</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>) </span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>   <span class="co"># pdf("daily_SFG_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a><span class="co"># pngfile &lt;- fs::path(knitr::fig_path(),  "scaling.png")</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a><span class="co"># agg_png(pngfile, width = 6.5, height = 1.5, units = "in", res = 300, scaling = 3)</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(p)</span></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a><span class="co"># invisible(dev.off())</span></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::include_graphics(pngfile)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf("daily_SFG_int2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>n_dates <span class="ot">&lt;-</span> <span class="fu">length</span>(new_intake<span class="sc">$</span>date)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(new_intake<span class="sc">$</span>date)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(joule_mass)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>new.joule_mass <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(joule_mass, <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="dv">1</span>], x[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">1</span>])))</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Low,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span>n_dates,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">70</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Daily SFG"</span>, <span class="st">"Cumulative SFG"</span>),</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span><span class="fu">c</span>(<span class="st">"orange"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Mid,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span>n_dates,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">70</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 4) </span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, daily_SFG<span class="sc">$</span>Upper,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)  </span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date,new.joule_mass[<span class="dv">2</span><span class="sc">:</span>n_dates,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">70</span>),<span class="at">axes=</span><span class="cn">FALSE</span>,<span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">xaxt=</span><span class="st">"n"</span>) <span class="co">#Low</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>) </span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.off()</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   189 obs. of  3 variables:
 $ V36 : num  48.4 47.9 47.6 47.2 46.7 ...
 $ V100: num  48.6 48.4 48.3 47.9 48 ...
 $ V121: num  46.2 46.3 46.5 46.8 47.2 ...</code></pre>
</div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/SFG-timeseries-cumulative-overlay_T2-1.png" class="img-fluid" width="624"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc daily air and water temp ####</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Look to see if/where data is missing</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp<span class="fl">.2</span><span class="sc">$</span>datetime,air.temp<span class="fl">.2</span><span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2018-08-10"</span>),<span class="fu">as.POSIXct</span>(<span class="st">"2018-12-01"</span>)))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(water.temp<span class="fl">.2</span><span class="sc">$</span>datetime,water.temp<span class="fl">.2</span><span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="st">"."</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2018-08-10"</span>),<span class="fu">as.POSIXct</span>(<span class="st">"2018-11-01"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aug 22 - Aug 25</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  air.temp.int <span class="ot">&lt;-</span> air.temp<span class="fl">.1</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  water.temp.int <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>air.temp.int <span class="ot">&lt;-</span> air.temp<span class="fl">.2</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>water.temp.int <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>daily_air_temp <span class="ot">&lt;-</span> air.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">mean</span>(Low,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">mean</span>(Mid,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">mean</span>(Upper,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  199 failed to parse.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>daily_air_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 199 × 4
   date         Low   Mid Upper
   &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2018-08-15  17.5  17.9  16.9
 2 2018-08-16  14.3  16.2  15.7
 3 2018-08-17  12.3  15.7  15.7
 4 2018-08-18  11.9  13.8  16.8
 5 2018-08-19  12.6  13.2  15.7
 6 2018-08-20  14.5  15.2  16.4
 7 2018-08-21  15.1  15.9  16.6
 8 2018-08-22  15.9  16.8  16.7
 9 2018-08-23  14.4  15.3  15.2
10 2018-08-24  15.9  17.7  16.0
# ℹ 189 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>daily_water_temp <span class="ot">&lt;-</span> water.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">mean</span>(Low,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">mean</span>(Mid,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">mean</span>(Upper,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  199 failed to parse.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upper 75% quantile ####</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#A quartile is the value of the quantile at the probabilities 0.25, 0.5 and 0.75.</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/26532566/quantile-vs-quartile-in-lay-terms</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant <span class="ot">&lt;-</span> air.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">quantile</span>(Low, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">quantile</span>(Mid, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">quantile</span>(Upper, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  199 failed to parse.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant_low <span class="ot">&lt;-</span> air.temp.int <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(datetime))) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Low =</span> <span class="fu">quantile</span>(Low, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Mid =</span> <span class="fu">quantile</span>(Mid, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Upper =</span> <span class="fu">quantile</span>(Upper, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `group_by()`.
ℹ In argument: `date = as.Date(ymd_hms(datetime))`.
Caused by warning:
!  199 failed to parse.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>daily_air_temp <span class="ot">&lt;-</span> daily_air_temp[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>daily_water_temp <span class="ot">&lt;-</span> daily_water_temp[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant <span class="ot">&lt;-</span> daily_air_temp_quant[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>daily_air_temp_quant_low <span class="ot">&lt;-</span> daily_air_temp_quant_low[<span class="dv">2</span><span class="sc">:</span>cutoff,]</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot temp, 6.5X1.5 ####</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Note dimensions must be called within pdf() - also saving as a .pdf through th GUI is broken. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temp_incl_3Q.pdf", width=6.5, height=1.5)</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(daily_air_temp<span class="sc">$</span>Mid, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1415278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temp ("</span>,degree,<span class="st">"C)"</span>)), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/timeseries_temp_quantile-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temp_incl_3Q.pdf", width=6.5, height=1.5)</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(daily_air_temp<span class="sc">$</span>Mid, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1415278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temp ("</span>,degree,<span class="st">"C)"</span>), <span class="at">xaxt=</span><span class="st">"n"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Low, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Mid, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(daily_air_temp<span class="sc">$</span>date, daily_air_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkorchid4"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_water_temp<span class="sc">$</span>date, daily_water_temp<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(daily_air_temp_quant<span class="sc">$</span>date, daily_air_temp_quant<span class="sc">$</span>Upper, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/timeseries_temp_quantile2-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("temp_legend_incl_3Q.pdf", width=6.5, height=1.5)</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span> ,<span class="at">xaxt=</span><span class="st">'n'</span>,<span class="at">yaxt=</span><span class="st">'n'</span>,<span class="at">bty=</span><span class="st">'n'</span>,<span class="at">ylab=</span><span class="st">''</span>,<span class="at">xlab=</span><span class="st">''</span>, <span class="at">xlim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topleft"</span>,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"75%-ile low tide temp"</span>, <span class="st">"Low tide temp"</span>,  <span class="st">"Water temp"</span>),</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span><span class="fu">c</span>(<span class="st">"darkred"</span>,<span class="st">"darkorchid4"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  air.temp.interval <span class="ot">&lt;-</span> air.temp<span class="fl">.1</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  water.temp.interval <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  food.int <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span><span class="sc">$</span>food</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  datetime.int <span class="ot">&lt;-</span> water.temp<span class="fl">.1</span><span class="sc">$</span>datetime</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1")</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(timing <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  air.temp.interval <span class="ot">&lt;-</span> air.temp<span class="fl">.2</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  water.temp.interval <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  food.int <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span><span class="sc">$</span>food</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  datetime.int <span class="ot">&lt;-</span> water.temp<span class="fl">.2</span><span class="sc">$</span>datetime</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 2")</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>air.temp.day <span class="ot">&lt;-</span> <span class="fu">cbind</span>(air.temp.interval,<span class="at">day =</span> <span class="fu">yday</span>(air.temp.interval<span class="sc">$</span>datetime))</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>air.temp_count_U <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp.day[,<span class="st">"Upper"</span>]),air.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>air.temp_count_M <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp.day[,<span class="st">"Mid"</span>]),air.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>air.temp_count_L <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(air.temp.day[,<span class="st">"Low"</span>]),air.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>air.temp.count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> air.temp_count_U,</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mid =</span> air.temp_count_M,</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Low =</span> air.temp_count_L</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>water.temp.day <span class="ot">&lt;-</span> <span class="fu">cbind</span>(water.temp.interval,<span class="at">day =</span> <span class="fu">yday</span>(water.temp.interval<span class="sc">$</span>datetime))</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>water.temp_count_U <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(water.temp.day[,<span class="st">"Upper"</span>]),water.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>water.temp_count_M <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(water.temp.day[,<span class="st">"Mid"</span>]),water.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>water.temp_count_L <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="sc">!</span><span class="fu">is.na</span>(water.temp.day[,<span class="st">"Low"</span>]),water.temp.day<span class="sc">$</span>day, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>water.temp.count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> water.temp_count_U,</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mid =</span> water.temp_count_M,</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Low =</span> water.temp_count_L</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(water.temp.count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   199 obs. of  3 variables:
 $ Upper: int  15 29 52 55 53 56 52 47 51 45 ...
 $ Mid  : int  50 56 59 61 60 62 60 56 60 63 ...
 $ Low  : int  62 61 64 67 66 68 66 63 66 69 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>water.temp.count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Upper Mid Low
1      15  50  62
2      29  56  61
3      52  59  64
4      55  61  67
5      53  60  66
6      56  62  68
7      52  60  66
8      47  56  63
9      51  60  66
10     45  63  69
11     28  61  68
12     27  58  70
13     24  33  73
14     24  35  68
15     27  54  73
16     34  63  71
17     57  63  69
18     57  63  69
19     56  63  67
20     54  60  64
21     55  61  64
22     52  58  62
23     37  62  66
24     33  47  64
25     21  48  60
26     19  32  56
27     20  28  50
28     19  31  64
29     22  59  67
30     45  61  67
31     51  60  65
32     55  60  66
33     53  60  66
34     53  60  66
35     53  60  66
36     42  60  66
37     29  59  65
38     18  49  65
39     19  45  66
40     18  47  64
41     19  40  68
42     20  47  74
43     24  56  77
44     29  65  75
45     54  65  72
46     56  64  70
47     55  62  66
48     52  58  64
49     38  57  61
50     31  57  62
51     31  52  66
52     26  40  56
53     25  44  56
54     22  45  57
55     18  40  56
56     18  43  71
57     14  59  69
58     21  58  67
59     21  56  66
60      0   0   0
227    18  42  61
228    19  40  59
229    17  33  59
230    16  43  65
231    16  50  65
232    20  55  63
233    23  55  63
234    31  56  64
235    37  58  64
236    27  57  64
237    22  58  65
238    17  56  66
239    15  49  66
240    12  46  68
241    13  43  65
242    14  42  60
243    14  38  60
244    14  37  71
245    14  43  66
246    16  54  63
247    22  53  61
248    24  54  61
249    29  55  61
250    30  57  63
251    30  59  64
252    28  51  68
253    28  46  69
254    24  43  58
255    19  41  57
256    16  43  61
257    14  44  69
258    22  59  68
259    27  59  67
260    12  54  63
261    12  52  62
262    11  52  62
263    11  52  63
264    12  48  66
265    15  53  68
266    10  40  67
267     8  35  55
268     0  32  51
269     0  34  50
270     1  38  55
271    16  46  71
272    28  63  71
273    33  61  69
274    42  60  68
275    43  59  65
276    42  55  63
277    18  56  64
278    16  57  65
279    21  52  68
280    13  41  60
281    19  42  57
282    24  44  59
283    22  44  58
284    23  44  69
285    23  48  66
286    20  51  64
287    13  54  62
288    14  52  61
289    17  49  60
290    19  47  62
291    16  34  64
292    13  28  66
293    12  25  69
294    13  38  65
295    13  40  61
296    18  48  66
297    22  46  68
298    29  52  71
299    35  64  68
300    33  60  65
301    47  61  66
302    43  58  64
303    37  55  61
304    27  56  63
305    23  54  62
306    21  50  67
307    16  27  58
308    16  43  61
309    15  41  59
310    15  43  62
311    19  43  66
312    16  44  64
313    21  56  62
314    24  56  61
315    19  54  60
316    20  51  59
317    23  52  60
318    24  50  61
319    22  36  58
320    19  32  63
321    15  27  40
322    16  26  47
323    16  26  60
324    15  46  71
325    32  63  70
326    45  63  68
327    56  63  69
328    54  60  66
329    51  58  63
330    53  59  63
331    55  61  66
332    53  60  65
333    48  60  66
334    27  60  68
335    24  33  73
336    21  30  61
337    17  39  66
338    16  45  66
339    26  59  64
340    32  58  64
341    45  58  63
342    50  58  63
343    49  58  63
344    50  59  63
345    47  58  64
346    44  60  66
347    31  57  66
348    35  61  71
349    29  60  71
350    31  41  96
351    29  56  87
352    52  71  82
353    51  65  73
354    54  62  68
355    57  63  68
356    53  59  63
357    56  62  66
358    54  59  64
359    54  59  63
360    44  58  63
361    35  53  63
362    23  40  63
363    25  32  69
364    21  30  58
365    17  27  56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>water.temp.count<span class="sc">$</span>Upper[<span class="fu">is.nan</span>(water.temp.count<span class="sc">$</span>Upper)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>water.temp.count<span class="sc">$</span>Mid[<span class="fu">is.nan</span>(water.temp.count<span class="sc">$</span>Mid)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>water.temp.count<span class="sc">$</span>Low[<span class="fu">is.nan</span>(water.temp.count<span class="sc">$</span>Low)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>air.temp.count<span class="sc">$</span>Low[<span class="fu">is.nan</span>(air.temp.count<span class="sc">$</span>Low)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>air.temp.count<span class="sc">$</span>Mid[<span class="fu">is.nan</span>(air.temp.count<span class="sc">$</span>Mid)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>air.temp.count<span class="sc">$</span>Upper[<span class="fu">is.nan</span>(air.temp.count<span class="sc">$</span>Upper)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>time.submerged <span class="ot">&lt;-</span> water.temp.count <span class="sc">/</span> (water.temp.count <span class="sc">+</span> air.temp.count)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co"># time.submerged[water.temp.count$Upper&lt;=10 |air.temp.count$Upper&lt;=18,"Upper"]&lt;- NA #Wow - actually there is one day with &lt;10 intervals submerged - that is 2.5 hours.</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># time.submerged[water.temp.count$Mid&lt;=10 |air.temp.count$Mid&lt;=18,"Mid"]&lt;- NA</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co"># time.submerged[water.temp.count$Low&lt;=10 |air.temp.count$Low&lt;=18,"Low"]&lt;- NA</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>time.submerged[water.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>air.temp.count<span class="sc">$</span>Upper<span class="sc">&lt;=</span><span class="dv">95</span>,<span class="st">"Upper"</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>time.submerged[water.temp.count<span class="sc">$</span>Mid<span class="sc">+</span>air.temp.count<span class="sc">$</span>Mid<span class="sc">&lt;=</span><span class="dv">95</span>,<span class="st">"Mid"</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>time.submerged[water.temp.count<span class="sc">$</span>Low<span class="sc">+</span>air.temp.count<span class="sc">$</span>Low<span class="sc">&lt;=</span><span class="dv">95</span>,<span class="st">"Low"</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time.submerged<span class="sc">$</span>Low, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'l'</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">180</span>,<span class="dv">200</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(air.temp.count<span class="sc">$</span>Upper<span class="sc">+</span>water.temp.count<span class="sc">$</span>Upper, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">195</span>,<span class="dv">200</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">96</span>), <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-27-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot time submerged, pretty version LMU, 6.5X1.5 dim ####</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Documents/GitHub/Bglandula_FHL_energetics/plots")</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("submergence_time2.pdf", width=6.5, height=1.5)</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, time.submerged<span class="sc">$</span>Low[<span class="dv">2</span><span class="sc">:</span>cutoff],<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.Date</span>(water.temp.int<span class="sc">$</span>datetime), food.int<span class="sc">/</span>(food.int<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co">#axis(side = 4, at = pretty(range(c(0,1))))      # Add second axis</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"bottomleft"</span>,</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Food availability"</span>,<span class="st">"Time submerged"</span>),</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">box.lty=</span><span class="dv">0</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, time.submerged<span class="sc">$</span>Mid[<span class="dv">2</span><span class="sc">:</span>cutoff],<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.Date</span>(water.temp.int<span class="sc">$</span>datetime), food.int<span class="sc">/</span>(food.int<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a><span class="co">#axis(side = 4, at = pretty(range(c(0,1))))      # Add second axis</span></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_intake<span class="sc">$</span>date, time.submerged<span class="sc">$</span>Upper[<span class="dv">2</span><span class="sc">:</span>cutoff],<span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Physiological rate (J / day)"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.Date</span>(water.temp.int<span class="sc">$</span>datetime), food.int<span class="sc">/</span>(food.int<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a><span class="co">#axis(side = 4, at = pretty(range(c(0,1))))      # Add second axis</span></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Food availability (unitless)"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)  </span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/timeseries_food_submergence_time-1.png" class="img-fluid" width="624"></p>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot food over time ####</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("~/Box/Sarah and Molly's Box/FHL data/plots/Interval 1 and 2")</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("Food availability over time_int1and2.pdf", width=6.5*1.5, height=1.5*1.5)</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mar = c(5, 4, 4, 5) + 0.3)              # Additional space for second y-axis</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(x, y1, pch = 16, col = 2)              # Create first plot</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="co"># par(new = TRUE)                             # Add new plot</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(x, y2, pch = 17, col = 3,              # Create second plot without axes</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co">#      axes = FALSE, xlab = "", ylab = "")</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axis(side = 4, at = pretty(range(y2)))      # Add second axis</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mtext("y2", side = 4, line = 3)  </span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.1</span><span class="sc">$</span>datetime, food.list[[<span class="dv">1</span>]]<span class="sc">/</span>(food.list[[<span class="dv">1</span>]]<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">yaxs =</span> <span class="st">"i"</span>,<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.1</span><span class="sc">$</span>datetime, food.list[[<span class="dv">1</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">axes =</span> <span class="cn">FALSE</span>,  <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>,<span class="at">lty =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">""</span>)                           <span class="co"># Add new plot</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">at =</span> <span class="fu">pretty</span>(<span class="fu">range</span>(food.list[[<span class="dv">1</span>]])))      <span class="co"># Add second axis</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"ug / L Chl"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)  </span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round), <span class="fu">max</span>(df_round), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>  df_round<span class="fl">.2</span><span class="ot">&lt;-</span>water.temp<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">modified_df =</span> <span class="fu">round_date</span>(datetime, <span class="at">unit=</span><span class="st">"month"</span>))</span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>  df_round<span class="fl">.2</span> <span class="ot">&lt;-</span> df_round<span class="fl">.2</span><span class="sc">$</span>modified_df</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.2</span><span class="sc">$</span>datetime, food.list[[<span class="dv">2</span>]]<span class="sc">/</span>(food.list[[<span class="dv">2</span>]]<span class="sc">+</span>par[<span class="dv">3</span>]), <span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),  <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"Food availability"</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(water.temp<span class="fl">.2</span><span class="sc">$</span>datetime, food.list[[<span class="dv">2</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),  <span class="at">axes =</span> <span class="cn">FALSE</span>,<span class="at">cex =</span> .<span class="dv">5</span>,</span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxs =</span> <span class="st">"i"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">""</span>)</span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">at =</span> <span class="fu">pretty</span>(<span class="fu">range</span>(food.list[[<span class="dv">1</span>]])))      <span class="co"># Add second axis</span></span>
<span id="cb97-43"><a href="#cb97-43" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"ug / L Chl"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)  </span>
<span id="cb97-44"><a href="#cb97-44" aria-hidden="true" tabindex="-1"></a> <span class="fu">axis.Date</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(df_round<span class="fl">.2</span>), <span class="fu">max</span>(df_round<span class="fl">.2</span>), <span class="at">by=</span><span class="st">"2 mon"</span>), <span class="at">format=</span><span class="st">"%b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="model_graphs_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>